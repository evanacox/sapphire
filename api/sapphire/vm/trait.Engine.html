<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Abstract interface for an “engine” that can execute SIR."><title>Engine in sapphire::vm - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-cb6f1f67f1bcd037.css" id="mainThemeStyle"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="sapphire" data-themes="" data-resource-suffix="" data-rustdoc-version="1.73.0-nightly (1b198b3a1 2023-08-13)" data-channel="nightly" data-search-js="search-6dfdfced5eff6596.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-8c76f75bfb6bd192.css" data-theme-light-css="light-1596385f77d47ef2.css" data-theme-dark-css="dark-0a43001d3fc2282c.css" data-theme-ayu-css="ayu-fd19013d6ce078bf.css" ><script src="../../static.files/storage-db41da1a38ea3cb8.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../static.files/main-0795b7d26be81095.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../../static.files/light-1596385f77d47ef2.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../../static.files/dark-0a43001d3fc2282c.css"><link rel="stylesheet" href="../../static.files/noscript-cffde32267a19fd6.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/katex.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/katex.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/contrib/auto-render.min.js"></script>
</head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../sapphire/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../../sapphire/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Engine</a></h2><div class="sidebar-elems"><section><h3><a href="#required-methods">Required Methods</a></h3><ul class="block"><li><a href="#tymethod.register_external_function">register_external_function</a></li><li><a href="#tymethod.run">run</a></li><li><a href="#tymethod.run_c">run_c</a></li><li><a href="#tymethod.with_module">with_module</a></li></ul><h3><a href="#implementors">Implementors</a></h3></section><h2><a href="index.html">In sapphire::vm</a></h2></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Trait <a href="../index.html">sapphire</a>::<wbr><a href="index.html">vm</a>::<wbr><a class="trait" href="#">Engine</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../../src/sapphire/vm/engine.rs.html#45-77">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub trait Engine {
    // Required methods
    fn <a href="#tymethod.with_module" class="fn">with_module</a>(module: <a class="struct" href="../ir/struct.Module.html" title="struct sapphire::ir::Module">Module</a>) -&gt; Self;
<span class="item-spacer"></span>    unsafe fn <a href="#tymethod.register_external_function" class="fn">register_external_function</a>&lt;T: <a class="trait" href="https://doc.rust-lang.org/nightly/core/any/trait.Any.html" title="trait core::any::Any">Any</a>&gt;(
        name: &amp;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a>,
        func: extern &quot;C&quot; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.fn.html">fn</a>() -&gt; T
    );
<span class="item-spacer"></span>    unsafe fn <a href="#tymethod.run" class="fn">run</a>(entry: &amp;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="enum" href="enum.GenericForeignValue.html" title="enum sapphire::vm::GenericForeignValue">GenericForeignValue</a>&gt;;
<span class="item-spacer"></span>    unsafe fn <a href="#tymethod.run_c" class="fn">run_c</a>(args: &amp;[&amp;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a>]) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.i32.html">i32</a>;
}</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Abstract interface for an “engine” that can execute SIR.</p>
<p>How the engine decides to do that is completely irrelevant, this interface
only exposes the basic operations that are necessary for a user of that
engine to actually do meaningful work with it.  </p>
</div></details><h2 id="required-methods" class="small-section-header">Required Methods<a href="#required-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="tymethod.with_module" class="method"><a class="src rightside" href="../../src/sapphire/vm/engine.rs.html#47">source</a><h4 class="code-header">fn <a href="#tymethod.with_module" class="fn">with_module</a>(module: <a class="struct" href="../ir/struct.Module.html" title="struct sapphire::ir::Module">Module</a>) -&gt; Self</h4></section></summary><div class="docblock"><p>Creates an engine instance that will execute <code>module</code>.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.register_external_function" class="method"><a class="src rightside" href="../../src/sapphire/vm/engine.rs.html#57">source</a><h4 class="code-header">unsafe fn <a href="#tymethod.register_external_function" class="fn">register_external_function</a>&lt;T: <a class="trait" href="https://doc.rust-lang.org/nightly/core/any/trait.Any.html" title="trait core::any::Any">Any</a>&gt;(
    name: &amp;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a>,
    func: extern &quot;C&quot; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.fn.html">fn</a>() -&gt; T
)</h4></section></summary><div class="docblock"><p>Registers a function with a given name as the definition for
a function <em>only declared</em> in the SIR.</p>
<h5 id="safety"><a href="#safety">Safety</a></h5>
<p>This function <strong>must</strong> match the signature of the associated declaration
in the SIR, this condition cannot be checked but if it is not true, the interpreter
will end up calling this function with invalid arguments (and the behavior
of the program will become undefined).</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.run" class="method"><a class="src rightside" href="../../src/sapphire/vm/engine.rs.html#67">source</a><h4 class="code-header">unsafe fn <a href="#tymethod.run" class="fn">run</a>(entry: &amp;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="enum" href="enum.GenericForeignValue.html" title="enum sapphire::vm::GenericForeignValue">GenericForeignValue</a>&gt;</h4></section></summary><div class="docblock"><p>Runs the entry point specified by <code>entry</code>. The value returned
by that function (if it isn’t <code>void</code>) is returned.</p>
<h5 id="safety-1"><a href="#safety-1">Safety</a></h5>
<p>If the SIR being executed has undefined behavior, the behavior of this
call is undefined. Implementations should attempt to detect UB and abort where
doing does not have a significant impact on performance, but obviously that is
not possible in the general case.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.run_c" class="method"><a class="src rightside" href="../../src/sapphire/vm/engine.rs.html#76">source</a><h4 class="code-header">unsafe fn <a href="#tymethod.run_c" class="fn">run_c</a>(args: &amp;[&amp;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a>]) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.i32.html">i32</a></h4></section></summary><div class="docblock"><p>Runs the module as-if it was a C program, and returns the result.</p>
<p>This will operate as-if the C runtime is correctly initialized as needed,
and the entry point is assumed to be <code>int main(int, char**)</code>.</p>
<h5 id="safety-2"><a href="#safety-2">Safety</a></h5>
<p>See the ‘Safety’ section on <a href="trait.Engine.html#tymethod.run"><code>Self::run</code></a>.</p>
</div></details></div><h2 id="implementors" class="small-section-header">Implementors<a href="#implementors" class="anchor">§</a></h2><div id="implementors-list"></div><script src="../../implementors/sapphire/vm/engine/trait.Engine.js" async></script></section></div></main><script>
renderMathInElement(document.body, {
    delimiters: [
        {left: "$$", right: "$$", display: true},
        {left: "\\[", right: "\\]", display: true},
        {left: "\\(", right: "\\)", display: false},
        {left: "$", right: "$", display: false}
    ]
});
</script>
</body></html>